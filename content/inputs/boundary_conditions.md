---
title: "Boundary Conditions"
type: "post"
weight: 2
lastmod: "2019-05-30"
---

# Boundary Conditions

## Base

| Input Variable               | Type                | Default Value | Note  | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| :------------:               | :-----------:       | :-----:       | :---: | :--------------------------------------------------------------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `bc_input`                   | `bc_input_t`        | \\            | \\    | Derived type to specify boundary conditions. An iterative loop will go through the specified flow conditions and try to compute the remaining unspecified flow conditions. <br> <span style="color:blue">NOTE</span>: A run-time error will occur if either of the following conditions are true: <br> A) The flow conditions are over-specified and inconsistent <br> B) The flow conditions are under-specified and it is unable to compute the remaining unspecified flow conditions. <br> <span style="color:blue">EXAMPLE</span>: An example of a well defined boundary condition using `bc_input`: <br> $\bullet$ `bc_input(1)%name = inflow_subsonic` <br> $\bullet$ `bc_input(1)%bc_type_string = SubInflow ! Subsonic Inflow BC` <br> $\bullet$ `bc_input(1)%p_static = 101325.0` <br> $\bullet$ `bc_input(1)%p_total = 121286.025` <br> $\bullet$ `bc_input(1)%t_total = 293.15` <br> <span style="color:blue">NOTE</span>: You must specify all BCs which should be consistent with those in the grid file. |
| `bc_input(1)%name`           | `character(len=32)` | `""`          | \\    | Character string that matches the name of a boundary group in the grid file. <br> <span style="color:blue">NOTE</span>: Case (upper/lower-case) does NOT matter. For the periodic BC, in the GMSH grid file, the user has to specify which face group pairs which one. For example, the face group no.4 is named `Periodic-1` and it pairs face group no.5. So the face group no.5 must be named `Periodic-2`. In the meantime, another periodic face group pair is named `Periodic-3` and `Periodic-4`. The ending number is used to pair face groups.                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `bc_input(1)%bc_type_string` | `character(len=32)` | `""`          | \\    | The boundary conditions are specified in the grid file and the array `bface(1,:)` is updated accordingly. BC by this `bc_type_string` must be consistent with the grid BC. Because `bc_input` is used to set up `bc_in`. One of the usages of `bc_in` is to provide the flow condition for a BC. <br> Valid values for boundary condition types are (Not complete): <br> $\bullet$ Fix all : `Fixed` <br> $\bullet$ Generic inflow: `Inflow`, `Inlet` <br> $\bullet$ Subsonic inflow : `SubInflow` <br> $\bullet$ No-slip adiabatic wall : `AdiabaticWall` <br> $\bullet$ Slip wall : `SlipWall`                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `bc_input(1)%p_static`       | `real`              | `-1.0`        | \\    | Static pressure (units of Pa).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `bc_input(1)%t_static`       | `real`              | `-1.0`        | \\    | Static temperature (units of Kelvin).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `bc_input(1)%rho_static`     | `real`              | `-1.0`        | \\    | Static density (units of $kg/m^3$)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `bc_input(1)%mach`           | `real`              | `0.4`         | \\    | Mach number. (dimensionless)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `bc_input(1)%vx`             | `real`              | `0.0`         | \\    | Velocity in the x coordinate direction (units of m/s)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `bc_input(1)%vy`             | `real`              | `0.0`         | \\    | Velocity in the y coordinate direction (units of m/s)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `bc_input(1)%vz`             | `real`              | `0.0`         | \\    | Velocity in the z coordinate direction (units of m/s)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `bc_input(1)%p_total`        | `real`              | `-1.0`        | \\    | Total pressure (units of Pa).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `bc_input(1)%t_total`        | `real`              | `-1.0`        | \\    | Total temperature (units of Kelvin).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `bc_input(1)%rho_total`      | `real`              | `-1.0`        | \\    | Total density (units of $kg/m^3$)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `bc_input(1)%alpha_aoa`      | `real`              | `0.0`         | \\    | Angle of attack in the $x-y$ plane. (dimensionless)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `bc_input(1)%beta_aoa`       | `real`              | `0.0`         | \\    | Angle of attack in the $x-z$ plane. (dimensionless)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `bc_input(1)%wall_temp`      | `real`              | `-1.0`        | \\    | Temperature for isothermal wall (units of Kelvin).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `walls_are_exact`            | `logical`           | `.TRUE.`      | \\    | Logical flag that determines if the solution on wall boundary conditions are treated as either the exact flow conditions or the ghost state that equals the exact flow conditions when averaged with the interior state. <br> $\bullet$ `.TRUE. :=` The wall boundary solution is the exact wall boundary condition, e.g., $[u_{wall}; v_{wall}; w_{wall}] = 0$ for a no-slip wall. <br> $\bullet$ `.FALSE. :=` The average of the wall boundary solution and the interior solution on the boundary face recovers the exact wall boundary condition, e.g., $[u_{wall}; v_{wall}; w_{wall}] = − [u_{wall}; v_{wall}; w_{wall}]$ for a no-slip wall. <br> <span style="color:blue">NOTE</span>: Hartmann (2014) reports that using exact wall boundary conditions seems to be more accurate on coarse grids and for lower values of solution order, whereas using the averaging method seems to be a little more stable. Details can be found at `http://elib.dlr.de/90967/1/hartmann_leicht_VKI_LS_2014-3.pdf`          |
| `sub_inflow_method`          | `integer`           | `1`           | \\    | Specifies which subsonic inflow boundary condition algorithm to use. <br> $\bullet$ `1 :=` Hold the total pressure and total temperature constant at the inflow, use the outgoing characteristic from the interior to perform a Newton iteration to get the static temperature, speed of sound, and normal velocity magnitude for the exterior state. <br> $\bullet$ `2 :=` Use the inflow static density and velocity, and the interior static pressure. <br> $\bullet$ `3 :=` Hold the inflow total pressure and total temperature constant, and use the interior velocity. <br> $\bullet$ `4 :=` Hold the inflow total pressure and total temperature constant, and use the interior static pressure. <br> <span style="color:blue">NOTE</span>: It is highly recommended to use option 1.                                                                                                                                                                                                                          |

## Custom Profile

| Input Variable            | Type                 | Default Value | Note  | Description                                                                                                                                                                                                                                  |
| :------------:            | :-----------:        | :-----:       | :---: | :--------------------------------------------------------------------------------                                                                                                                                                            |
| `cpbc_prof_input`         | `prof_input_t`  | \\            | \\    | Input file for the custom profile BC. The first line of the input file is a comment line starting with `!`.                                                                                                                                  |
| `cpbc_prof_input%fname`   | `character(len=256)` | `""`          | \\    | File name of the input file for the custom profile BC.                                                                                                                                                                                       |
| `cpbc_prof_input%fdelim`  | `character`          | `,`           | \\    | Column delimiter in the input file for the custom profile BC.                                                                                                                                                                                |
| `cpbc_prof_input%dat_dir` | `character`          | `""`          | \\    | The input profile is a 1D curve for each primitive variable. `dat_dir` indicates the direction along with the input profile is distributed. Valid values are `X` or `Y`. `Z` is always the spanwise direction in 3D. In 2D, there is no `Z`. |

## Inflow Turbulence Generation

| Input Variable              | Type                 | Default Value | Note  | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| :------------:              | :-----------:        | :-----:       | :---: | :--------------------------------------------------------------------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `tgbc_input`                | `tgbc_input_t`       | \\            | \\    | Background mesh parameters for turbulence generation BC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `tgbc_input%ncz`            | `integer`            | `0`           | \\    | The number of grid cells along the $z$ direction in the background mesh for the turbulence generation BC. $z$ direction is assumed to be the spanwise direction in 3D simulation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `tgbc_input%ncy_1`          | `integer`            | `0`           | \\    | The number of grid cells along the $y$ direction in the background mesh section 1 for the turbulence generation BC. There are 3 sections along the $y$ direction. Only the first 2 sections span the background mesh. The 3rd section is the farfield section without turbulence.                                                                                                                                                                                                                                                                                                                                                                         |
| `tgbc_input%ncy_2`          | `integer`            | `0`           | \\    | The number of grid cells along the $y$ direction in the background mesh section 2 for the turbulence generation BC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `tgbc_input%yl`             | `real`               | `1E12`        | \\    | The lower bound of the domain of the background mesh along $y$ direction.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `tgbc_input%yh_1`           | `real`               | `0.0`         | \\    | The upper bound of the domain of the background mesh along $y$ direction for the section 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `tgbc_input%yh_2`           | `real`               | `0.0`         | \\    | The upper bound of the domain of the background mesh along $y$ direction for the section 2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `tgbc_input%yh_3`           | `real`               | `5E11`        | \\    | The upper bound of the domain of the background mesh along $y$ direction for the section 3. This should be the upper limiter of the inlet plane of the real grid.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `tgbc_input%zl`             | `real`               | `1E12`        | \\    | The lower bound of the domain of the background mesh along $z$ direction. $z$ direction is the spanwise direction. In 3D, `zl` and `zh` are always required.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `tgbc_input%zh`             | `real`               | `0.0`         | \\    | The upper bound of the domain of the background mesh along $z$ direction.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `tgbc_input%delta_99`       | `real`               | `0.0`         | \\    | The boundary layer thickness at the inlet plane. This value is used the basis to calculate various integral length scale.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `tgbc_input%ilsx_s1`        | `real`               | `0.2`         | \\    | The ratio of integral length scale for the $x$ direction in the section 1. This ratio times the boundary layer thickness give you the physical integral length scale for the $x$ direction.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `tgbc_input%ilsx_s2`        | `real`               | `0.6`         | \\    | The ratio of integral length scale for the $x$ direction in the section 2. This ratio times the boundary layer thickness give you the physical integral length scale for the $x$ direction.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `tgbc_input%ilsy_s1`        | `real`               | `0.2`         | \\    | The ratio of integral length scale for the $y$ direction in the section 1. This ratio times the boundary layer thickness give you the physical integral length scale for the $y$ direction.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `tgbc_input%ilsy_s2`        | `real`               | `0.5`         | \\    | The ratio of integral length scale for the $y$ direction in the section 2. This ratio times the boundary layer thickness give you the physical integral length scale for the $y$ direction.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `tgbc_input%ilsz_s1`        | `real`               | `0.6`         | \\    | The ratio of integral length scale for the $z$ direction in the section 1. This ratio times the boundary layer thickness give you the physical integral length scale for the $z$ direction.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `tgbc_input%ilsz_s2`        | `real`               | `0.6`         | \\    | The ratio of integral length scale for the $z$ direction in the section 2. This ratio times the boundary layer thickness give you the physical integral length scale for the $z$ direction.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `tgbc_input%inflow_u`       | `real`               | `-1.0`        | \\    | The freestream velocity at the the inlet plane. This velocity is the basis to calculate the integral time scale.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `tgbc_input%ius_1`          | `real`               | `0.2`         | \\    | The ratio of the streamwise velocity in the section 1. This value times the inflow freestream velocity gives you the velocity value used in the calculation of the integral time scale in the section 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `tgbc_input%ius_2`          | `real`               | `0.6`         | \\    | The ratio of the streamwise velocity in the section 2. This value times the inflow freestream velocity gives you the velocity value used in the calculation of the integral time scale in the section 2.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `tgbc_input%RetSts_fname`   | `character(len=256)` | `""`          | \\    | File name of the input file for the Reynolds stress profile.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| `tgbc_input%ReySts_fdelim`  | `character`          | `,`           | \\    | Column delimiter in the input file for the Reynolds stress profile.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `tgbc_input%VarMean_fname`  | `character(len=256)` | `""`          | \\    | File name of the input file for the mean flow profile.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `tgbc_input%VarMean_fdelim` | `character`          | `,`           | \\    | Column delimiter in the input file for the mean flow profile.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `tgbc_input%subtype`        | `integer`            | `1`           | \\    | Specify the way how generated turbulence is incorporated into the flow. When the inflow turbulence is generated at the inlet plane, a bunch of values are avaible at the inlet plane. Should we assign them to the ghost cell values directly? Or use another way? <br> $\bullet$ `1 :=` Calculate the local Mach number. If supersonic, directly assign the generated turbulence to the ghost cells. If not, assign all variables to ghost cells except for the pressure which is taken from the interior cell. It is the same as `INFLOW` <br> $\bullet$ `2 :=` Directly assign the generated turbulence to the ghost cells. It is the same as `FIXED`. |
| `tgbc_input%dump_prof`      | `logical`            | `.FALSE.`     | \\    | Logical flag that enables/disables dumping various profiles in the turbulence generation BC. So you can debug it. Only when the executable is compiled with the pre-processing keyword `DEBUG_ON` this input parameter could work. Because otherwise, relavant codes are not compiled into the executable.                                                                                                                                                                                                                                                                                                                                                |

